<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zekai Admin Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin_panel.css') }}">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-gear-fill me-2"></i>Zekai Admin Paneli
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" id="nav-dashboard" href="#">Gösterge Paneli</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="nav-categories" href="#">Kategoriler</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="nav-models" href="#">Modeller</a>
                    </li>
                </ul>
                <div class="d-flex">
                    <span class="navbar-text me-3">
                        <i class="bi bi-person-circle me-1"></i>Admin
                    </span>
                    <button class="btn btn-outline-light btn-sm" id="logoutBtn">
                        <i class="bi bi-box-arrow-right me-1"></i>Çıkış Yap
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-3">
        <div id="alertContainer"></div>
    </div>

    <div class="container mt-3">
        <div id="dashboard-section" class="content-section active">
            <div class="row">
                <div class="col-12">
                    <div class="card shadow-sm">
                        <div class="card-header bg-light">
                            <h5 class="card-title mb-0">
                                <i class="bi bi-speedometer2 me-2"></i>Gösterge Paneli
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card bg-primary text-white">
                                        <div class="card-body">
                                            <h5 class="card-title">
                                                <i class="bi bi-folder me-2"></i>Kategoriler
                                            </h5>
                                            <h2 id="categoryCount">0</h2>
                                            <p class="card-text">Toplam AI kategorileri</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card bg-success text-white">
                                        <div class="card-body">
                                            <h5 class="card-title">
                                                <i class="bi bi-robot me-2"></i>AI Modelleri
                                            </h5>
                                            <h2 id="modelCount">0</h2>
                                            <p class="card-text">Toplam AI modelleri</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card bg-info text-white">
                                        <div class="card-body">
                                            <h5 class="card-title">
                                                <i class="bi bi-activity me-2"></i>Sistem Durumu
                                            </h5>
                                            <h2 id="systemStatus">Aktif</h2> <p class="card-text">Tüm sistemler çalışır durumda</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-4">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header bg-light">
                                            <h6 class="mb-0">Hızlı İşlemler</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="d-flex flex-wrap gap-2">
                                                <button class="btn btn-primary" id="quick-add-category">
                                                    <i class="bi bi-plus-circle me-1"></i>Kategori Ekle
                                                </button>
                                                <button class="btn btn-success" id="quick-add-model">
                                                    <i class="bi bi-plus-circle me-1"></i>AI Modeli Ekle
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="categories-section" class="content-section">
            <div class="card shadow-sm">
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-folder me-2"></i>AI Kategorileri
                    </h5>
                    <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                        <i class="bi bi-plus-circle me-1"></i>Kategori Ekle
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>İkon</th>
                                    <th>İsim</th>
                                    <th>Modeller</th>
                                    <th>Eylemler</th>
                                </tr>
                            </thead>
                            <tbody id="categoriesTableBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="models-section" class="content-section">
            <div class="card shadow-sm">
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-robot me-2"></i>AI Modelleri
                    </h5>
                    <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#addModelModal">
                        <i class="bi bi-plus-circle me-1"></i>Model Ekle
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>İkon</th>
                                    <th>İsim</th>
                                    <th>Kategori</th>
                                    <th>Data AI Index</th>
                                    <th>API URL</th>
                                    <th>Eylemler</th>
                                </tr>
                            </thead>
                            <tbody id="modelsTableBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addCategoryModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-folder-plus me-2"></i>Yeni Kategori Ekle
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addCategoryForm">
                        <div class="mb-3">
                            <label for="categoryName" class="form-label">Kategori Adı</label>
                            <input type="text" class="form-control" id="categoryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="categoryIcon" class="form-label">İkon</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i id="iconPreview" class="bi bi-folder"></i>
                                </span>
                                <select class="form-select" id="categoryIcon" required>
                                    </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-primary" id="saveCategoryBtn">Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="editCategoryModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-pencil-square me-2"></i>Kategoriyi Düzenle
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editCategoryForm">
                        <input type="hidden" id="editCategoryId">
                        <div class="mb-3">
                            <label for="editCategoryName" class="form-label">Kategori Adı</label>
                            <input type="text" class="form-control" id="editCategoryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editCategoryIcon" class="form-label">İkon</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i id="editIconPreview" class="bi bi-folder"></i>
                                </span>
                                <select class="form-select" id="editCategoryIcon" required>
                                    </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-primary" id="updateCategoryBtn">Güncelle</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addModelModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg"> <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-plus-circle me-2"></i>Yeni AI Modeli Ekle
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addModelForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="modelCategory" class="form-label">Kategori</label>
                                    <select class="form-select" id="modelCategory" required>
                                        </select>
                                </div>
                                <div class="mb-3">
                                    <label for="modelName" class="form-label">Model Adı</label>
                                    <input type="text" class="form-control" id="modelName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="modelIcon" class="form-label">İkon</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i id="modelIconPreview" class="bi bi-robot"></i>
                                        </span>
                                        <select class="form-select" id="modelIcon" required>
                                            </select>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="modelDataAiIndex" class="form-label">Data AI Index</label>
                                    <input type="text" class="form-control" id="modelDataAiIndex" required>
                                    <div class="form-text">Ön yüzde kullanılan benzersiz tanımlayıcı (örn: Gemini için "5")</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="modelApiUrl" class="form-label">API URL/Anahtar</label>
                                    <input type="text" class="form-control" id="modelApiUrl" required>
                                    <div class="form-text">Bu model için API anahtarı veya uç nokta URL'si</div>
                                </div>
                                <div class="mb-3">
                                    <label for="modelRequestMethod" class="form-label">İstek Metodu</label>
                                    <select class="form-select" id="modelRequestMethod">
                                        <option value="POST" selected>POST</option>
                                        <option value="GET">GET</option>
                                    </select>
                                    <div class="form-text">API istekleri için HTTP metodu</div>
                                </div>
                                 <div class="mb-3">
                                    <label for="modelResponsePath" class="form-label">Yanıt Yolu</label>
                                    <input type="text" class="form-control" id="modelResponsePath" value="candidates[0].content.parts[0].text">
                                    <div class="form-text">API JSON yanıtından yanıt metnini çıkarmak için yol</div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                               <div class="mb-3">
                                    <label for="modelRequestHeaders" class="form-label">İstek Başlıkları (JSON)</label>
                                    <textarea class="form-control" id="modelRequestHeaders" rows="3">{"Content-Type": "application/json"}</textarea>
                                    <div class="form-text">API istekleri için başlıkları içeren JSON nesnesi</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                 <div class="mb-3">
                                    <label for="modelRequestBody" class="form-label">İstek Gövdesi Şablonu (JSON)</label>
                                    <textarea class="form-control" id="modelRequestBody" rows="3">{"contents": [{"parts":[{"text": "$message"}]}]}</textarea>
                                    <div class="form-text">İstek gövdesi için JSON şablonu. Kullanıcı mesajı için $message kullanın.</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-success" id="saveModelBtn">Modeli Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="editModelModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg"> <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-pencil-square me-2"></i>AI Modelini Düzenle
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editModelForm">
                        <input type="hidden" id="editModelId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editModelCategory" class="form-label">Kategori</label>
                                    <select class="form-select" id="editModelCategory" required>
                                        </select>
                                </div>
                                <div class="mb-3">
                                    <label for="editModelName" class="form-label">Model Adı</label>
                                    <input type="text" class="form-control" id="editModelName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editModelIcon" class="form-label">İkon</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i id="editModelIconPreview" class="bi bi-robot"></i>
                                        </span>
                                        <select class="form-select" id="editModelIcon" required>
                                            </select>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="editModelDataAiIndex" class="form-label">Data AI Index</label>
                                    <input type="text" class="form-control" id="editModelDataAiIndex" required>
                                    <div class="form-text">Ön yüzde kullanılan benzersiz tanımlayıcı</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editModelApiUrl" class="form-label">API URL/Anahtar</label>
                                    <input type="text" class="form-control" id="editModelApiUrl" required>
                                    <div class="form-text">Bu model için API anahtarı veya uç nokta URL'si</div>
                                </div>
                                <div class="mb-3">
                                    <label for="editModelRequestMethod" class="form-label">İstek Metodu</label>
                                    <select class="form-select" id="editModelRequestMethod">
                                        <option value="POST">POST</option>
                                        <option value="GET">GET</option>
                                    </select>
                                    <div class="form-text">API istekleri için HTTP metodu</div>
                                </div>
                                <div class="mb-3">
                                    <label for="editModelResponsePath" class="form-label">Yanıt Yolu</label>
                                    <input type="text" class="form-control" id="editModelResponsePath">
                                    <div class="form-text">API JSON yanıtından yanıt metnini çıkarmak için yol</div>
                                </div>
                            </div>
                        </div>
                         <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editModelRequestHeaders" class="form-label">İstek Başlıkları (JSON)</label>
                                    <textarea class="form-control" id="editModelRequestHeaders" rows="3"></textarea>
                                    <div class="form-text">API istekleri için başlıkları içeren JSON nesnesi</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editModelRequestBody" class="form-label">İstek Gövdesi Şablonu (JSON)</label>
                                    <textarea class="form-control" id="editModelRequestBody" rows="3"></textarea>
                                    <div class="form-text">İstek gövdesi için JSON şablonu. Kullanıcı mesajı için $message kullanın.</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-success" id="updateModelBtn">Modeli Güncelle</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-exclamation-triangle me-2"></i>Silme Onayı
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="deleteConfirmMessage">Bu öğeyi silmek istediğinizden emin misiniz?</p>
                    <p class="text-danger"><strong>Bu işlem geri alınamaz.</strong></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Sil</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/admin_panel.js') }}"></script>
</body>
</html>