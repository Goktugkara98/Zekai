<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zekai</title>
    
    <!-- Bruno Ace SC Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bruno+Ace+SC&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chat Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat/chat.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat/sidebar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat/chat-panes.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat/input-bar.css') }}">
    <script src="{{ url_for('static', filename='js/shared/logo-fit.js') }}" defer></script>
    {% if branding %}
    <style>
      :root {
        --brand-text-color: {{ (branding.text_color_light or '#0f172a')|safe }};
        --brand-border-color: {{ (branding.border_color_light or '#e5e7eb')|safe }};
      }
      body.dark-theme {
        --brand-text-color: {{ (branding.text_color_dark or '#e8eaf0')|safe }};
        --brand-border-color: {{ (branding.border_color_dark or '#243049')|safe }};
      }
    </style>
    {% endif %}
<!-- Preloader styles are in chat.css -->
<!-- Preloader styles are in chat.css -->
</head>
<body class="preloading">
<div id="preloader" class="preloader">
    <div class="preloader-inner">
        <div class="logo">zekai</div>
        <div class="spinner"></div>
    </div>
    <div class="preloader-bg"></div>
</div>
<div class="chat-container">
    <!-- Sidebar -->
    <aside class="chat-sidebar">
        <!-- Logo Section (logo only) -->
        <div class="sidebar-logo">
            {% set logo_path = branding.logo_path if branding else None %}
            <div class="logo-row only-logo">
                <div id="sidebarLogoBox" class="logo-box-horizontal">
                  {% if logo_path %}
                  <img id="sidebarLogoImg" class="logo-img" src="{{ url_for('static', filename=logo_path) }}" alt="Logo">
                  {% else %}
                  <i class="fas fa-robot logo-fallback"></i>
                  {% endif %}
                </div>
            </div>
        </div>

        <!-- Scrollable Content -->
        <div class="sidebar-content">
            <!-- Pinned Models Only -->
            <div class="sidebar-section">
                <div class="section-header" data-target="favorite-models">
                    <div class="section-title" data-i18n="ai_models">YAPAY ZEKA MODELLERİ</div>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </div>
                <div class="collapsible-content open" id="favorite-models">
                    <div class="model-list" id="favorite-model-list">
                        <!-- Pinned models will be listed here -->
                    </div>
                </div>
                <!-- Inline Manage Models under the models list -->
                <div class="models-inline-action">
                    <button class="pin-more-btn" title="Modelleri Yönet" aria-label="Modelleri Yönet">
                        <i class="fas fa-sliders-h"></i>
                        <span>Modelleri Yönet</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- models manage moved under models list -->

        <!-- Profile Card (replaces bottom links) -->
        <div class="sidebar-bottom">
            <div class="profile-card">
                <div class="profile-header" role="button" title="Profil ve Ayarlar" data-i18n="profile_settings" data-i18n-attr="title">
                    <div class="profile-avatar" id="profile-avatar">ZU</div>
                    <div class="profile-info">
                        <div class="profile-name" id="profile-name">{{ user_name or 'Zekai User' }}</div>
                        <div class="profile-email" id="profile-email">{{ user_email or 'user@example.com' }}</div>
                    </div>
                    <div class="profile-toggle">
                        <i class="fas fa-chevron-up"></i>
                    </div>
                </div>
                <div class="profile-settings">
                    <div class="setting-item">
                        <div class="setting-label"><i class="fas fa-moon"></i><span data-i18n="label_dark_mode">Karanlık Mod</span></div>
                        <label class="switch">
                            <input type="checkbox" id="toggle-darkmode">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label"><i class="fas fa-bell"></i><span data-i18n="label_notifications">Bildirimler</span></div>
                        <label class="switch">
                            <input type="checkbox" id="toggle-notifications">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label"><i class="fas fa-language"></i><span data-i18n="label_language">Dil</span></div>
                        <select id="select-language" class="setting-select">
                            <option value="tr">Türkçe</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                    <!-- Minimal quick links for chats -->
                    <div class="profile-quick-links">
                        <button class="profile-link open-active-chats" type="button">
                            <i class="fas fa-bolt"></i>
                            <span data-i18n="sidebar_active_chats">Aktif Sohbetler</span>
                        </button>
                        <button class="profile-link open-chat-history" type="button">
                            <i class="fas fa-clock"></i>
                            <span data-i18n="sidebar_history">Sohbet Geçmişi</span>
                        </button>
                    </div>

                    <button class="logout-btn" id="btn-logout"><i class="fas fa-sign-out-alt"></i><span data-i18n="logout">Çıkış Yap</span></button>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
        <!-- Chat Panes Container -->
        <div class="chat-panes-container">
            <!-- Empty State -->
            <div class="empty-chat-state">
                <h2>zekai</h2>
                <p data-i18n="app_welcome_desc">Select a model from the sidebar to start chatting</p>
            </div>
        </div>
    </main>

    <!-- Input Bar -->
    <div class="input-bar">
        <div class="input-container">
            <textarea 
                class="message-input" 
                placeholder="Bu alana yazdığınız mesaj, ekranda açık olan tüm sohbetlere gönderilir (karşılaştırma için)."
                rows="1"
            ></textarea>
        </div>

        <div class="input-actions">
            <button class="action-btn prompts-btn">
                <i class="fas fa-lightbulb"></i>
                <span>Öneriler</span>
            </button>
            <button class="action-btn send-btn">
                <i class="fas fa-paper-plane"></i>
                <span>Gönder</span>
            </button>
        </div>
    </div>
</div>

<!-- Markdown Libraries -->
<script src="https://cdn.jsdelivr.net/npm/dompurify@2.5.4/dist/purify.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<!-- Chat App -->
<script type="module" src="{{ url_for('static', filename='js/chat/chat-new.js') }}"></script>
<script>
  (function(){
    function initLogoFit(){
      try {
        if (window.LogoFit) {
          const box = document.getElementById('sidebarLogoBox');
          const img = document.getElementById('sidebarLogoImg');
          window.LogoFit.fitLogoBox(box, img, 180, 56);
        }
      } catch(_) {}
    }
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initLogoFit);
    } else {
      initLogoFit();
    }
    window.addEventListener('load', initLogoFit);
  })();
</script>
</body>
</html>
